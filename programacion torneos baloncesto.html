<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Torneo de Baloncesto</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f2f2f2;
            margin: 0;
            padding: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #4CAF50;
            color: white;
        }
        button {
            padding: 10px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            margin-top: 20px;
        }
        button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <h1>Programa del Torneo de Baloncesto</h1>
    <input type="file" id="fileInput" accept=".xlsx" />
    
    <!-- Primera tabla: Torneo 1 -->
    <h2>Torneo 1</h2>
    <table id="gamesTable1">
        <thead>
            <tr>
                <th>Juego</th>
                <th>Equipo 1</th>
                <th>Equipo 2</th>
                <th>Árbitro 1</th>
                <th>Árbitro 2</th>
                <th>Árbitro 3</th>
                <th>Hora</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Juego 1</td>
                <td>Equipo A</td>
                <td>Equipo B</td>
                <td><select id="ref1"></select></td>
                <td><select id="ref2"></select></td>
                <td><select id="ref3"></select></td>
                <td><input type="time" id="time1"></td>
            </tr>
            <tr>
                <td>Juego 2</td>
                <td>Equipo C</td>
                <td>Equipo D</td>
                <td><select id="ref4"></select></td>
                <td><select id="ref5"></select></td>
                <td><select id="ref6"></select></td>
                <td><input type="time" id="time2"></td>
            </tr>
            <tr>
                <td>Juego 3</td>
                <td>Equipo E</td>
                <td>Equipo F</td>
                <td><select id="ref7"></select></td>
                <td><select id="ref8"></select></td>
                <td><select id="ref9"></select></td>
                <td><input type="time" id="time3"></td>
            </tr>
        </tbody>
    </table>

    <!-- Segunda tabla: Torneo 2 -->
    <h2>Torneo 2</h2>
    <table id="gamesTable2">
        <thead>
            <tr>
                <th>Juego</th>
                <th>Equipo 1</th>
                <th>Equipo 2</th>
                <th>Árbitro 1</th>
                <th>Árbitro 2</th>
                <th>Árbitro 3</th>
                <th>Hora</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Juego 1</td>
                <td>Equipo G</td>
                <td>Equipo H</td>
                <td><select id="ref10"></select></td>
                <td><select id="ref11"></select></td>
                <td><select id="ref12"></select></td>
                <td><input type="time" id="time4"></td>
            </tr>
            <tr>
                <td>Juego 2</td>
                <td>Equipo I</td>
                <td>Equipo J</td>
                <td><select id="ref13"></select></td>
                <td><select id="ref14"></select></td>
                <td><select id="ref15"></select></td>
                <td><input type="time" id="time5"></td>
            </tr>
            <tr>
                <td>Juego 3</td>
                <td>Equipo K</td>
                <td>Equipo L</td>
                <td><select id="ref16"></select></td>
                <td><select id="ref17"></select></td>
                <td><select id="ref18"></select></td>
                <td><input type="time" id="time6"></td>
            </tr>
        </tbody>
    </table>

    <!-- Botón para imprimir resultados -->
    <button id="printButton">Imprimir Resultados</button>

    <script>
        let arbitros = [];

        document.getElementById('fileInput').addEventListener('change', handleFileSelect, false);
        document.getElementById('printButton').addEventListener('click', printResults, false);

        function handleFileSelect(event) {
            const file = event.target.files[0];
            const reader = new FileReader();

            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, {type: 'array'});
                const sheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[sheetName];
                const json = XLSX.utils.sheet_to_json(worksheet, {header: 1});
                
                arbitros = json.flat();

                // Llenar los menús desplegables con árbitros para ambos torneos
                fillRefDropdowns();
            };

            reader.readAsArrayBuffer(file);
        }

        function fillRefDropdowns() {
            // Función para llenar los menús desplegables con los árbitros
            for (let i = 1; i <= 18; i++) { // Cambiado a 18 para incluir árbitros para ambos torneos
                const select = document.getElementById(`ref${i}`);
                select.innerHTML = ''; // Limpiar opciones anteriores

                arbitros.forEach((arbitro) => {
                    const option = document.createElement('option');
                    option.textContent = arbitro;
                    select.appendChild(option);
                });
            }
        }

        function printResults() {
            // Crear una nueva ventana para imprimir los resultados
            const printWindow = window.open('', '', 'height=600,width=800');
            printWindow.document.write('<html><head><title>Resultados del Torneo</title>');
            printWindow.document.write('<style>table { width: 100%; border-collapse: collapse; } th, td { border: 1px solid #ccc; padding: 10px; text-align: left; } th { background-color: #4CAF50; color: white; }</style>');
            printWindow.document.write('</head><body>');
            printWindow.document.write('<h1>Resultados del Torneo 1</h1>');
            printWindow.document.write('<table><thead><tr><th>Juego</th><th>Equipo 1</th><th>Equipo 2</th><th>Árbitro 1</th><th>Árbitro 2</th><th>Árbitro 3</th><th>Hora</th></tr></thead><tbody>');

            appendGames(printWindow, 'gamesTable1');
            printWindow.document.write('</tbody></table>');
            
            printWindow.document.write('<h1>Resultados del Torneo 2</h1>');
            printWindow.document.write('<table><thead><tr><th>Juego</th><th>Equipo 1</th><th>Equipo 2</th><th>Árbitro 1</th><th>Árbitro 2</th><th>Árbitro 3</th><th>Hora</th></tr></thead><tbody>');

            appendGames(printWindow, 'gamesTable2');
            printWindow.document.write('</tbody></table>');
            printWindow.document.write('</body></html>');
            printWindow.document.close();
            printWindow.print();
        }

        function appendGames(printWindow, tableId) {
            const rows = document.querySelectorAll(`#${tableId} tbody tr`);
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                const arbitro1 = cells[3].querySelector('select').selectedOptions[0].textContent;
                const arbitro2 = cells[4].querySelector('select').selectedOptions[0].textContent;
                const arbitro3 = cells[5].querySelector('select').selectedOptions[0].textContent;
                const hora = cells[6].querySelector('input[type="time"]').value;

                printWindow.document.write('<tr>');
                printWindow.document.write(`<td>${cells[0].textContent}</td>`);
                printWindow.document.write(`<td>${cells[1].textContent}</td>`);
                printWindow.document.write(`<td>${cells[2].textContent}</td>`);
                printWindow.document.write(`<td>${arbitro1}</td>`);
                printWindow.document.write(`<td>${arbitro2}</td>`);
                printWindow.document.write(`<td>${arbitro3}</td>`);
                printWindow.document.write(`<td>${hora}</td>`);
                printWindow.document.write('</tr>');
            });
        }
    </script>
</body>
</html>
